         6881 function calls (6771 primitive calls) in 0.044 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.001    0.000    0.044    0.004 /home/user/PycharmProjects/tmp/BERTAP_v2/src/scripts/batch_samplers.py:65(sample_fn)
       10    0.011    0.001    0.031    0.003 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/flax/jax_utils.py:274(pad_shard_unpad_wrapper)
    80/50    0.004    0.000    0.026    0.001 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/tree_util.py:279(tree_map)
  350/290    0.002    0.000    0.023    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/tree_util.py:321(<genexpr>)
       30    0.001    0.000    0.018    0.001 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/flax/jax_utils.py:308(unpad)
       30    0.001    0.000    0.016    0.001 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/api.py:2661(device_get)
       60    0.001    0.000    0.012    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/profiler.py:332(wrapper)
       10    0.001    0.000    0.011    0.001 /home/user/PycharmProjects/tmp/BERTAP_v2/src/datasets/dataloaders.py:125(sample)
       60    0.001    0.000    0.007    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/array.py:138(_create_copy_plan)
       30    0.003    0.000    0.006    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/array.py:603(copy_to_host_async)
       30    0.000    0.000    0.006    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/api.py:2651(_device_get)
       30    0.000    0.000    0.006    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/array.py:404(__array__)
       30    0.002    0.000    0.005    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/array.py:614(_value)
      240    0.001    0.000    0.005    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/array.py:60(_get_device)
      480    0.003    0.000    0.004    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/array.py:489(devices)
       10    0.000    0.000    0.002    0.000 /home/user/PycharmProjects/tmp/BERTAP_v2/src/datasets/dataset.py:46(get_subset)
       50    0.000    0.000    0.002    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/numpy/core/fromnumeric.py:2979(prod)
       70    0.002    0.000    0.002    0.000 /home/user/PycharmProjects/tmp/BERTAP_v2/src/datasets/dataloaders.py:141(<lambda>)
       50    0.000    0.000    0.001    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/numpy/core/fromnumeric.py:71(_wrapreduction)
       10    0.000    0.000    0.001    0.000 /home/user/PycharmProjects/tmp/BERTAP_v2/src/datasets/dataloaders.py:79(_sample_ids)
       10    0.000    0.000    0.001    0.000 /home/user/PycharmProjects/tmp/BERTAP_v2/src/datasets/dataloaders.py:119(_sample_sub_goal_ids)
       10    0.001    0.000    0.001    0.000 /home/user/PycharmProjects/tmp/BERTAP_v2/src/datasets/normalizers.py:21(normalize)
       10    0.000    0.000    0.001    0.000 {method 'choice' of 'numpy.random.mtrand.RandomState' objects}
       10    0.000    0.000    0.001    0.000 /home/user/PycharmProjects/tmp/BERTAP_v2/src/datasets/dataloaders.py:18(batched_randint)
       70    0.001    0.000    0.001    0.000 /home/user/PycharmProjects/tmp/BERTAP_v2/src/datasets/dataset.py:47(<lambda>)
      300    0.001    0.000    0.001    0.000 {built-in method builtins.next}
       10    0.000    0.000    0.001    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/flax/jax_utils.py:304(<listcomp>)
       20    0.000    0.000    0.001    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/flax/jax_utils.py:299(maybe_pad)
       50    0.001    0.000    0.001    0.000 {method 'reduce' of 'numpy.ufunc' objects}
       10    0.000    0.000    0.001    0.000 /home/user/PycharmProjects/tmp/BERTAP_v2/src/datasets/dataloaders.py:61(_make_valid_indices)
       30    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/contextlib.py:130(__enter__)
       30    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/contextlib.py:139(__exit__)
       70    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/numpy/core/shape_base.py:139(atleast_3d)
       80    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/tree_util.py:71(tree_flatten)
      540    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/array.py:583(_check_if_deleted)
       20    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/numpy/core/fromnumeric.py:1332(searchsorted)
       60    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/config.py:1427(explicit_device_get_scope)
      480    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/sharding_impls.py:430(device_set)
      630    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/array.py:253(sharding)
    80/60    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       20    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/numpy/core/fromnumeric.py:53(_wrapfunc)
       30    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/contextlib.py:279(helper)
       20    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/sharding_impls.py:485(__eq__)
       60    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/array.py:364(is_fully_replicated)
       20    0.000    0.000    0.000    0.000 /home/user/PycharmProjects/tmp/BERTAP_v2/src/datasets/dataloaders.py:9(broadcast_to)
       20    0.000    0.000    0.000    0.000 {method 'searchsorted' of 'numpy.ndarray' objects}
       10    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/typing.py:975(__instancecheck__)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       70    0.000    0.000    0.000    0.000 {method 'reshape' of 'numpy.ndarray' objects}
       20    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/flax/jax_utils.py:286(pad)
       40    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/tree_util.py:136(tree_leaves)
       30    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/contextlib.py:102(__init__)
       60    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/sharding_impls.py:494(__hash__)
       50    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/numpy/core/fromnumeric.py:72(<dictcomp>)
       10    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/typing.py:1130(__subclasscheck__)
      320    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       10    0.000    0.000    0.000    0.000 {method 'rand' of 'numpy.random.mtrand.RandomState' objects}
      150    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/array.py:237(shape)
       30    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/array.py:390(is_fully_addressable)
      240    0.000    0.000    0.000    0.000 {built-in method builtins.iter}
       30    0.000    0.000    0.000    0.000 {built-in method numpy.empty}
      310    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
       10    0.000    0.000    0.000    0.000 {method 'binomial' of 'numpy.random.mtrand.RandomState' objects}
      240    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
       10    0.000    0.000    0.000    0.000 {method 'repeat' of 'numpy.ndarray' objects}
       10    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/xla_bridge.py:1015(local_device_count)
       10    0.000    0.000    0.000    0.000 {built-in method numpy.arange}
       80    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/tree_util.py:320(<listcomp>)
       30    0.000    0.000    0.000    0.000 {built-in method numpy.asarray}
       10    0.000    0.000    0.000    0.000 {method 'astype' of 'numpy.ndarray' objects}
       10    0.000    0.000    0.000    0.000 /home/user/PycharmProjects/tmp/BERTAP_v2/src/datasets/normalizers.py:69(keys)
       10    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/abc.py:121(__subclasscheck__)
       60    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       10    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/flax/jax_utils.py:279(<setcomp>)
       70    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/numpy/core/shape_base.py:135(_atleast_3d_dispatcher)
       50    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/numpy/core/fromnumeric.py:2974(_prod_dispatcher)
       70    0.000    0.000    0.000    0.000 {built-in method numpy.asanyarray}
       70    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 /home/user/PycharmProjects/tmp/BERTAP_v2/src/scripts/batch_samplers.py:73(<listcomp>)
       20    0.000    0.000    0.000    0.000 /home/user/PycharmProjects/tmp/BERTAP_v2/src/datasets/dataset.py:61(__getitem__)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.max}
       10    0.000    0.000    0.000    0.000 {built-in method _abc._abc_subclasscheck}
       30    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/jax/_src/array.py:241(dtype)
       40    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       30    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/typing.py:1708(cast)
       20    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/numpy/core/fromnumeric.py:1328(_searchsorted_dispatcher)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
       10    0.000    0.000    0.000    0.000 {built-in method time.time}
       10    0.000    0.000    0.000    0.000 {method 'copy' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/numpy/core/multiarray.py:153(concatenate)
       10    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/flax/jax_utils.py:305(<dictcomp>)
       20    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 /home/user/anaconda3/envs/jax/lib/python3.10/site-packages/numpy/core/multiarray.py:346(where)
       10    0.000    0.000    0.000    0.000 {method 'pop' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}


